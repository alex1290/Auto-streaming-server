(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{102:function(e,n){},118:function(e,n){},120:function(e,n){},132:function(e,n,t){"use strict";t.r(n);var a=t(0),c=t.n(a),r=t(60),i=t.n(r),o=(t(71),t(33)),u=t.n(o),l=t(61),s=t(3),d=t(19),f=(t(73),t(23)),m=t.n(f),p=t(24),v=t.n(p),b=t(20);function O(){var e=Object(d.a)(["\n  padding: 0 5px;\n"]);return O=function(){return e},e}function j(){var e=Object(d.a)(["\n  border: 1px solid blue;\n  width: 80%;\n  height: 80%;\n  margin:auto;\n"]);return j=function(){return e},e}function E(){var e=Object(d.a)(["\n  display: flex;\n  width: 100%;\n"]);return E=function(){return e},e}function g(){var e=Object(d.a)(["\n  height: 100vh;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n"]);return g=function(){return e},e}var h=b.a.div(g()),D=b.a.div(E()),w=(b.a.video(j()),b.a.p(O()));var I=function(e){var n=Object(a.useState)(""),t=Object(s.a)(n,2),r=t[0],i=t[1],o=Object(a.useState)([]),d=Object(s.a)(o,2),f=d[0],p=d[1],b=Object(a.useState)(),O=Object(s.a)(b,2),j=O[0],E=(O[1],Object(a.useState)("none")),g=Object(s.a)(E,2),I=g[0],S=g[1],k=Object(a.useState)(),y=Object(s.a)(k,2),C=y[0],U=y[1],x=Object(a.useState)([]),J=Object(s.a)(x,2),N=J[0],R=J[1],A=Object(a.useState)(),P=Object(s.a)(A,2),M=(P[0],P[1],Object(a.useRef)(),Object(a.useRef)());Object(a.useEffect)((function(){M.current=m.a.connect(e.ip),M.current.emit("type","controller"),M.current.on("UUID",(function(e){i(e)})),M.current.on("adminID",(function(e){S(e)})),M.current.on("deviceConnect",(function(e){p(e)})),W("Desktop")}),[]);var W=function(){var e=Object(l.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"Camera"===n?navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){U(e)})):"Desktop"===n&&navigator.mediaDevices.getDisplayMedia({video:{width:{max:1280},height:{max:720}},audio:!1}).then((function(e){console.log("set"),U(e)}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function B(e){var n=JSON.parse(JSON.stringify(N)),t=new v.a({initiator:!0,trickle:!1,stream:C});t.on("signal",(function(n){M.current.emit("callDevice",{deviceId:e,signalData:n,adminPeerID:t._id})})),M.current.on("connectToDevice",(function(n){var a=n.userId,c=n.signal;e===a&&t.signal(c)})),M.current.on("deviceDisconnect",(function(n){e===n&&(t.end(),function(e){var n=JSON.parse(JSON.stringify(N)).filter((function(n){return n.deviceId!==e}));R(n)}(n))})),n.push({deviceId:e,peer:t}),R(n)}return Object(a.useEffect)((function(){var e=N.map((function(e){return e.deviceId}));C&&f.length>0&&f.forEach((function(n){e.includes(n)||B(n)}))}),[f,C]),c.a.createElement(h,null,c.a.createElement(D,null,c.a.createElement(w,null,"Update Ip Address : ",c.a.createElement("button",{onClick:function(){return M.current.emit("addr")}},"Update"))),c.a.createElement(D,null,c.a.createElement(w,null,"User Info : UUID = ",r),c.a.createElement(w,null,"Admin ID : ",I)),c.a.createElement(D,null,c.a.createElement(w,null,"Capture Source :",C?c.a.createElement("button",{onClick:function(){}},"Stop Capture"):c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{onClick:function(){return W("Camera")}},"Camera"),c.a.createElement("button",{onClick:function(){return W("Desktop")}},"Desktop")))),C&&c.a.createElement(D,null,c.a.createElement(w,null,"Device List :  ",f.map((function(e,n){return c.a.createElement("button",{key:n,onClick:function(){return B(e)}},"Call ",e)})))),c.a.createElement(D,null,j),c.a.createElement(D,null,j&&c.a.createElement("button",{className:"target",onClick:function(){return e=j,void M.current.emit("deviceReload",e);var e}},"Device Reload")))},S=function(e){var n,t=Object(a.useState)(""),r=Object(s.a)(t,2),i=r[0],o=r[1],u=Object(a.useState)("none"),l=Object(s.a)(u,2),d=l[0],f=l[1],p=Object(a.useState)(),b=Object(s.a)(p,2),O=b[0],j=b[1],E=Object(a.useState)(),g=Object(s.a)(E,2),h=g[0],D=g[1],w=Object(a.useState)(),I=Object(s.a)(w,2),S=(I[0],I[1],Object(a.useRef)()),k=Object(a.useRef)();return Object(a.useEffect)((function(){k.current=m.a.connect(e.ip),k.current.on("adminSignal",(function(e){D(e.signalData),j(e.adminPeerID)})),k.current.emit("type","device"),k.current.on("UUID",(function(e){o(e)})),k.current.on("adminID",(function(e){f(e)})),k.current.on("controllerDisconnect",(function(){window.location.reload()}))}),[]),Object(a.useEffect)((function(){h&&function(e){var n=new v.a({initiator:!1,trickle:!1});n.on("stream",(function(e){console.log("get stream"),console.log(e),S.current.srcObject=e})),n.on("signal",(function(e){k.current.emit("acceptCall",e)})),n.on("close",(function(){console.log("end"),n.end()})),n.signal(e)}(h)}),[h]),h&&(console.log(h),n=c.a.createElement("video",{width:window.innerWidth,height:window.innerHeight,playsInline:!0,muted:!0,ref:S,autoPlay:!0})),c.a.createElement("div",null,c.a.createElement("p",null,"User Info : UUID = ",i," "),c.a.createElement("p",null,"Admin ID : ",d),c.a.createElement("p",null,"Admin Peer ID : ",O),h&&c.a.createElement("div",{className:"video"},n))},k=t(65),y=t(1);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var C=window.location.origin;i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(k.a,null,c.a.createElement(y.c,null,c.a.createElement(y.a,{path:"/live"},c.a.createElement(S,{ip:C})),c.a.createElement(y.a,{path:"/"},c.a.createElement(I,{ip:C}))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},66:function(e,n,t){e.exports=t(132)},71:function(e,n,t){},73:function(e,n,t){}},[[66,1,2]]]);
//# sourceMappingURL=main.3c5f3a09.chunk.js.map